<!DOCTYPE html>
<html>
<head>
  <title>Check localStorage State</title>
  <style>
    body { font-family: system-ui; padding: 20px; max-width: 1000px; margin: 0 auto; }
    h1 { color: #0067C5; }
    pre { background: #f5f5f5; padding: 15px; border-radius: 4px; overflow-x: auto; }
    .section { margin: 20px 0; padding: 15px; border: 2px solid #ddd; border-radius: 8px; }
    .error { color: red; font-weight: bold; }
    .success { color: green; font-weight: bold; }
    button { padding: 10px 20px; font-size: 16px; background: #0067C5; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
    button:hover { background: #005ba3; }
    button.danger { background: #c30000; }
    button.danger:hover { background: #a00000; }
  </style>
</head>
<body>
  <h1>üîç localStorage Inspector</h1>
  
  <div class="section">
    <h2>Current localStorage State</h2>
    <button onclick="checkStorage()">Refresh Storage Check</button>
    <button class="danger" onclick="clearAndReload()">Clear Storage & Reload</button>
    <div id="storage-info"></div>
  </div>

  <div class="section">
    <h2>Project Data</h2>
    <div id="project-data"></div>
  </div>

  <div class="section">
    <h2>JSX Code</h2>
    <pre id="jsx-code">Loading...</pre>
  </div>

  <script>
    function checkStorage() {
      const info = document.getElementById('storage-info');
      const projectData = document.getElementById('project-data');
      const jsxCode = document.getElementById('jsx-code');

      // Check for project key
      const projectKey = 'aksel-arcade-project';
      const rawData = localStorage.getItem(projectKey);

      if (!rawData) {
        info.innerHTML = '<p class="error">‚ùå No project found in localStorage</p><p>This is a fresh user - will get new default code!</p>';
        projectData.innerHTML = '<p>No data</p>';
        jsxCode.textContent = 'No project in storage';
        return;
      }

      info.innerHTML = '<p class="success">‚úÖ Project found in localStorage</p>';

      try {
        const project = JSON.parse(rawData);
        
        // Display project metadata
        projectData.innerHTML = `
          <p><strong>ID:</strong> ${project.id || 'N/A'}</p>
          <p><strong>Name:</strong> ${project.name || 'N/A'}</p>
          <p><strong>Version:</strong> ${project.version || 'N/A'}</p>
          <p><strong>Created:</strong> ${project.createdAt || 'N/A'}</p>
          <p><strong>Modified:</strong> ${project.lastModified || 'N/A'}</p>
          <p><strong>Viewport:</strong> ${project.viewportSize || 'N/A'}</p>
        `;

        // Display JSX code
        jsxCode.textContent = project.jsxCode || 'No JSX code';

        // Check if code has the NEW default
        const hasNewDefault = project.jsxCode && project.jsxCode.includes('export default function App()') && project.jsxCode.includes('<Alert');
        const hasOldDefault = project.jsxCode && project.jsxCode.includes('<Button variant="primary">Button text</Button>');

        if (hasNewDefault) {
          jsxCode.style.borderLeft = '4px solid green';
          info.innerHTML += '<p class="success">‚úÖ Code has NEW default (Alert component)</p>';
        } else if (hasOldDefault) {
          jsxCode.style.borderLeft = '4px solid orange';
          info.innerHTML += '<p class="error">‚ö†Ô∏è Code has OLD default (Button component)</p>';
        } else {
          jsxCode.style.borderLeft = '4px solid blue';
          info.innerHTML += '<p>‚ÑπÔ∏è Code is custom (user-modified)</p>';
        }

      } catch (error) {
        info.innerHTML += `<p class="error">‚ùå Error parsing project: ${error.message}</p>`;
        projectData.innerHTML = `<pre>${rawData}</pre>`;
        jsxCode.textContent = 'Error parsing';
      }
    }

    function clearAndReload() {
      if (confirm('This will clear ALL localStorage and reload the page. Continue?')) {
        localStorage.clear();
        sessionStorage.clear();
        alert('Storage cleared! Page will reload.');
        window.location.reload();
      }
    }

    // Auto-check on load
    checkStorage();

    // Log to console too
    console.log('=== localStorage Inspector ===');
    console.log('Total keys:', localStorage.length);
    for (let i = 0; i < localStorage.length; i++) {
      const key = localStorage.key(i);
      console.log(`Key ${i}:`, key);
    }
  </script>
</body>
</html>
