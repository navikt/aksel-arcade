<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quick Sandbox Test</title>
  <style>
    body { padding: 2rem; font-family: monospace; }
    iframe { width: 100%; height: 400px; border: 2px solid red; }
    .log { margin: 0.5rem 0; padding: 0.5rem; background: #f5f5f5; }
    .error { background: #ffebee; color: #c62828; }
  </style>
</head>
<body>
  <h1>Quick Sandbox Test</h1>
  <div id="logs"></div>
  <iframe id="sandbox" src="/sandbox.html"></iframe>

  <script>
    const logs = document.getElementById('logs');
    const sandbox = document.getElementById('sandbox');
    
    function log(msg, isError = false) {
      const div = document.createElement('div');
      div.className = isError ? 'log error' : 'log';
      div.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
      logs.appendChild(div);
    }

    window.addEventListener('message', (e) => {
      if (!e.data?.type) return;
      log(`üì© Received: ${e.data.type}`);
      
      if (e.data.type === 'SANDBOX_READY') {
        log('‚úÖ Sandbox is ready, sending test code...');
        
        // Send simple button test
        setTimeout(() => {
          const code = `function App() {
  return React.createElement('div', null, 
    React.createElement('h1', null, 'Test'),
    React.createElement('button', null, 'Plain Button')
  );
}`;
          
          log('üì§ Sending plain React test (no Aksel)...');
          sandbox.contentWindow.postMessage({
            type: 'EXECUTE_CODE',
            payload: { jsxCode: code }
          }, '*');
        }, 500);
      } else if (e.data.type === 'RENDER_SUCCESS') {
        log('‚úÖ Render successful!');
        
        // Now try with Aksel Button
        setTimeout(() => {
          const code = `function App() {
  return React.createElement(Button, { variant: 'primary' }, 'Aksel Button');
}`;
          
          log('üì§ Sending Aksel Button test...');
          sandbox.contentWindow.postMessage({
            type: 'EXECUTE_CODE',
            payload: { jsxCode: code }
          }, '*');
        }, 2000);
      } else if (e.data.type === 'RUNTIME_ERROR') {
        log(`‚ùå Error: ${e.data.payload.message}`, true);
      }
    });

    log('üöÄ Waiting for sandbox to load...');
  </script>
</body>
</html>
